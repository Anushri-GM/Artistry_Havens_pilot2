
{
  "entities": {
    "User": {
      "title": "User",
      "type": "object",
      "description": "Represents a user of the application, who can be an artisan, buyer, or sponsor.",
      "properties": {
        "displayName": { "type": "string", "description": "User's display name." },
        "userType": { "type": "string", "description": "The type of user (artisan, buyer, or sponsor)." },
        "createdAt": { "type": "string", "format": "date-time", "description": "Timestamp of user creation." },
        "email": { "type": "string", "description": "User's email address." },
        "photoUrl": { "type": "string", "description": "URL of the user's profile picture." },
        "bio": { "type": "string", "description": "A short biography of the user." },
        "location": { "type": "string", "description": "User's primary shipping address." },
        "contactInfo": { "type": "string", "description": "User's contact information." },
        "categories": {
          "type": "array",
          "items": { "type": "string" },
          "description": "For artisans, this lists the craft categories they specialize in."
        }
      },
      "required": ["displayName", "userType", "createdAt"]
    },
    "Product": {
      "title": "Product",
      "type": "object",
      "description": "Represents a product listed by an artisan for sale.",
      "properties": {
        "name": { "type": "string", "description": "The name of the product." },
        "price": { "type": "number", "description": "The price of the product." },
        "description": { "type": "string", "description": "A detailed description of the product." },
        "story": { "type": "string", "description": "A short, engaging story about the product." },
        "mainImageUrl": { "type": "string", "description": "The main image URL for the product." },
        "createdAt": { "type": "string", "format": "date-time", "description": "Timestamp of product creation." },
        "updatedAt": { "type": "string", "format": "date-time", "description": "Timestamp of the last product update." },
        "artisan": { "$ref": "#/entities/User", "description": "A reference to the artisan who created the product." },
        "category": { "type": "string", "description": "The category the product belongs to." },
        "availableQuantity": { "type": "integer", "description": "The quantity of the product available for sale." }
      },
      "required": ["name", "price", "description", "mainImageUrl", "createdAt", "updatedAt"]
    },
    "CustomizationOption": {
      "title": "CustomizationOption",
      "type": "object",
      "description": "Represents a customization option available for a product.",
      "properties": {
        "optionName": { "type": "string", "description": "The name of the customization option (e.g., 'Color', 'Size')." },
        "optionType": { "type": "string", "description": "The type of input for the option (e.g., 'dropdown', 'text')." },
        "createdAt": { "type": "string", "format": "date-time", "description": "Timestamp of option creation." },
        "product": { "$ref": "#/entities/Product", "description": "A reference to the product this option belongs to." },
        "predefinedValues": { "type": "array", "items": { "type": "string" }, "description": "A list of predefined values for the option (e.g., ['Red', 'Blue', 'Green'])." },
        "inputInstructions": { "type": "string", "description": "Instructions for the user on how to provide customization input." }
      },
      "required": ["optionName", "optionType", "createdAt"]
    },
    "Order": {
      "title": "Order",
      "type": "object",
      "description": "Represents a purchase order made by a buyer.",
      "properties": {
        "orderDate": { "type": "string", "format": "date-time", "description": "The date the order was placed." },
        "totalAmount": { "type": "number", "description": "The total amount of the order." },
        "status": { "type": "string", "enum": ["Processing", "Shipped", "Delivered"], "description": "The current status of the order." },
        "createdAt": { "type": "string", "format": "date-time", "description": "Timestamp of order creation." },
        "updatedAt": { "type": "string", "format": "date-time", "description": "Timestamp of the last order update." },
        "buyer": { "$ref": "#/entities/User", "description": "A reference to the buyer who placed the order." },
        "artisan": { "$ref": "#/entities/User", "description": "A reference to the artisan fulfilling the order." },
        "product": { "$ref": "#/entities/Product", "description": "A reference to the product that was ordered. This can be null for custom orders." },
        "shippingAddress": { "type": "string", "description": "The shipping address for the order." },
        "paymentId": { "type": "string", "description": "The identifier for the payment transaction." },
        "customizationDetails": { "type": "string", "description": "Details about any customizations requested for the product." },
        "quantity": { "type": "integer", "description": "The quantity of the product ordered." },
        "productName": { "type": "string", "description": "Denormalized name of the product for easier display." },
        "productImageUrl": { "type": "string", "description": "Denormalized image URL of the product." },
        "buyerName": { "type": "string", "description": "Denormalized name of the buyer for easier display." },
        "artisanName": { "type": "string", "description": "Denormalized name of the artisan for easier display." }
      },
      "required": ["orderDate", "totalAmount", "status", "createdAt", "updatedAt", "buyer", "artisan", "quantity", "productName", "productImageUrl", "buyerName", "artisanName"]
    },
    "Review": {
      "title": "Review",
      "type": "object",
      "description": "Represents a review left by a buyer for a product.",
      "properties": {
        "rating": { "type": "integer", "description": "The numerical rating given (e.g., 1-5)." },
        "reviewText": { "type": "string", "description": "The text content of the review." },
        "createdAt": { "type": "string", "format": "date-time", "description": "Timestamp of when the review was submitted." },
        "buyer": { "$ref": "#/entities/User", "description": "A reference to the buyer who wrote the review." },
        "product": { "$ref": "#/entities/Product", "description": "A reference to the product being reviewed." },
        "artisan": { "$ref": "#/entities/User", "description": "A reference to the artisan of the product." },
        "imageUrls": { "type": "array", "items": { "type": "string" }, "description": "An array of image URLs submitted with the review." }
      },
      "required": ["rating", "reviewText", "createdAt"]
    },
    "CustomizationRequest": {
      "title": "CustomizationRequest",
      "type": "object",
      "description": "Represents a custom design request from a buyer, generated either from a text prompt or a reference image.",
      "properties": {
        "buyerId": { "type": "string", "description": "The UID of the buyer making the request." },
        "buyerName": { "type": "string", "description": "The denormalized name of the buyer." },
        "buyerShippingAddress": { "type": "string", "description": "The denormalized shipping address of the buyer." },
        "referenceImageUrl": { "type": "string", "description": "The optional data URI of the user-uploaded reference image." },
        "generatedImageUrl": { "type": "string", "description": "The data URI of the AI-generated image showing the requested changes." },
        "description": { "type": "string", "description": "The buyer's description of the requested changes." },
        "category": { "type": "string", "description": "The ID of the craft category for the request." },
        "status": { "type": "string", "enum": ["pending", "accepted", "rejected"], "description": "The status of the request." },
        "createdAt": { "type": "string", "format": "date-time", "description": "Timestamp of request creation." },
        "artisanId": { "type": "string", "description": "The UID of the artisan who accepted the request." },
        "artisanName": { "type": "string", "description": "The denormalized name of the artisan who accepted the request." },
        "price": { "type": "number", "description": "The AI-suggested price for the custom work." }
      },
      "required": ["buyerId", "buyerName", "buyerShippingAddress", "generatedImageUrl", "description", "category", "price", "createdAt"]
    },
    "Notification": {
      "title": "Notification",
      "type": "object",
      "description": "Represents a notification sent to a user.",
      "properties": {
        "userId": { "type": "string", "description": "The UID of the user receiving the notification." },
        "title": { "type": "string", "description": "The title of the notification." },
        "message": { "type": "string", "description": "The content of the notification message." },
        "type": { "type": "string", "enum": ["customization_request", "new_order", "sponsor_request", "milestone"], "description": "The type of notification." },
        "link": { "type": "string", "description": "A URL path to navigate to when the notification is clicked." },
        "isRead": { "type": "boolean", "description": "Indicates if the notification has been read." },
        "createdAt": { "type": "string", "format": "date-time", "description": "Timestamp of notification creation." },
        "requestId": { "type": "string", "description": "Optional ID of the associated request document." }
      },
      "required": ["userId", "title", "message", "type", "isRead", "createdAt", "link"]
    }
  },
  "auth": {
    "providers": [
      "phone"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "schema": { "$ref": "#/entities/User" },
          "description": "Stores user profiles. The userId matches the Firebase Auth UID."
        }
      },
      {
        "path": "/products/{productId}",
        "definition": {
          "schema": { "$ref": "#/entities/Product" },
          "description": "Stores all products listed on the platform."
        }
      },
      {
        "path": "/products/{productId}/customizationOptions/{optionId}",
        "definition": {
          "schema": { "$ref": "#/entities/CustomizationOption" },
          "description": "Stores customization options for a specific product."
        }
      },
      {
        "path": "/orders/{orderId}",
        "definition": {
          "schema": { "$ref": "#/entities/Order" },
          "description": "Stores all orders placed on the platform."
        }
      },
      {
        "path": "/reviews/{reviewId}",
        "definition": {
          "schema": { "$ref": "#/entities/Review" },
          "description": "Stores all reviews for products."
        }
      },
      {
        "path": "/CustomizationRequest/{requestId}",
        "definition": {
          "schema": { "$ref": "#/entities/CustomizationRequest" },
          "description": "Stores custom design requests from buyers. Artisans in the specified category can view and accept these requests."
        }
      },
      {
        "path": "/notifications/{notificationId}",
        "definition": {
          "schema": { "$ref": "#/entities/Notification" },
          "description": "Stores notifications for users, such as new requests or orders."
        }
      }
    ],
    "reasoning": "This Firestore data structure is designed around the new schema. It uses top-level collections for major entities like Users, Products, Orders, and Reviews for easier querying. Customization options are nested under their respective products. User-specific data is keyed by the Firebase Auth UID to ensure a direct and secure link between authentication and user data."
  }
}
